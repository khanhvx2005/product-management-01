extends ../../layouts/default.pug
include ../../mixins/alert.pug
block main 
    +alert_success("5000")
    section.content-section
        h3 Quản Lý Sản Phẩm
        .sort-controls-bar
            span.sort-label Sắp xếp:
            .sort-dropdown
                select(id = "sort-select" class ="form-control" name = "type" sort-select)
                    option(value='position-desc') Vị trí giảm dần
                    option(value='position-asc') Vị trí tăng dần
                    option(value='price-asc') Giá tăng dần
                    option(value='price-desc') Giá giảm dần
                    option(value='title-asc') Tiêu đề A - Z
                    option(value='title-desc') Tiêu đề Z - A
            button.btn-clear Clear
        .filter-controls-bar
            form(class="bulk-action-group" action = "/admin/products/change-multi?_method=PATCH" method = "POST" form-change-multi)
                div(class="dropdown")
                    select(class="form-control" id = "bulk-action-select" name = "type")
                        option(disabled selected) Chọn hành động
                        option(value='active') Hoạt động
                        option(value='inactive') Dừng hoạt động
                        option(value='delete-all') Xóa tất cả
                        option(value='change-position') Thay đổi vị trí
                    input(type = "text" name = "ids" class="d-none")
                button(class="btn-apply" type = "submit") Áp dụng
            form(class = "search-box" form-search)
                input(
                    placeholder="Nhập từ khóa" 
                    type="text"
                    name = "keyword"
                    value = keyword
                    )
                i(class="fas fa-search" type ="submit")
            .filter-dropdown
                label(for="status-filter") Trạng thái:
                select(id = "status-filter" button-status)
                    each item,index in filter
                        option(value=item.status selected = item.selected) #{item.name}
                        
                    
            a(class="btn-primary-add" type = "button" href = "/admin/products/create")
                i.fas.fa-plus
                | Thêm Sản Phẩm
    .product-list-table
        table(class="table-checkbox")
            thead
                tr
                    th 
                        input(type="checkbox" checkall)
                    th STT
                    th Ảnh
                    th Tên Sản Phẩm
                    th Giá
                    th Vị trí
                    th Trạng Thái
                    th(style = "text-align:center") Hành động
            tbody
                each item , index in records
                     
                        
                    tr
                        td 
                            input(type="checkbox" value = item.id name = "id")
                        td #{(pagination.currentPage - 1) * pagination.limitItem + (index + 1)}
                        td
                            img.product-thumb(
                            alt=item.title 
                            src=item.thumbnail
                            )
                        td #{item.title}
                        
                        td #{item.price}
                        td 
                            input(type = "number" value = item.position min = "1" name = "position" style ="width:60px")
                        td.status-in-stock
                            if(item.status == "active")
                                a(class = "badge badge-success" data-id = item.id data-status = item.status button-status-table href = "javascript:;") Hoạt động
                            else 
                                a(class = "badge badge-danger" data-id = item.id data-status = item.status button-status-table href = "javascript:;") Dừng hoạt động
                        td.action-buttons
                            a(class="btn-detail" title="Chi tiết" href=`/admin/products/details/${item.id}`)
                            i.fas.fa-eye
                            a(class="btn-edit" title="Sửa" href=`/admin/products/edit/${item.id}`)
                            i.fas.fa-edit
                            a(class = "btn-delete" title="Xóa" href="javascript:;" button-delete = item.id)
                            i.fas.fa-trash-alt
    
    nav(aria-label="Page navigation example" class = "pagination")
        ul.pagination
            if(pagination.currentPage > 1)
                li.page-item
                    a.page-link(aria-label="Previous" href="#" page = pagination.currentPage-1)
                        span(aria-hidden="true") «
            - for(let i = 1;i<=pagination.totalPage;i++)
                li(class=`page-item ${pagination.currentPage == i ? "active" : ""}`)
                    a.page-link(href="#" page = i) #{i}
            if(pagination.currentPage < pagination.totalPage)
                li.page-item
                    a.page-link(
                    aria-label="Next" 
                    href="#"
                    page = pagination.currentPage+1
                    )
                        span(aria-hidden="true") »
    form(action = ""
    path = "/admin/products/change-status"
    method = "POST"
    form-change-status
    )
    form(action = ""
    path = "/admin/products/delete"
    method = "POST"
    form-delete-items
    )
        

        